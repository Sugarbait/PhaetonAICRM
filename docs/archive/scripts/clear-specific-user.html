<!DOCTYPE html>
<html>
<head>
  <title>Clear Specific User Cache</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2563eb;
      margin-top: 0;
    }
    button {
      background: #ef4444;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
    }
    button:hover {
      background: #dc2626;
    }
    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 6px;
      display: none;
    }
    .status.success {
      background: #dcfce7;
      color: #166534;
      display: block;
    }
    .status.info {
      background: #dbeafe;
      color: #1e40af;
      display: block;
    }
    ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    li {
      margin: 8px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üóëÔ∏è Clear Specific User Cache</h1>
    <p>This will remove the cached user: <strong>elitesquadp@protonmail.com</strong></p>

    <div class="status info">
      <strong>What will be cleared:</strong>
      <ul>
        <li>User profile data for elitesquadp@protonmail.com</li>
        <li>System users list</li>
        <li>Current user session</li>
        <li>User settings</li>
      </ul>
    </div>

    <button onclick="clearSpecificUser()">Clear User Cache & Reload</button>

    <div id="status" class="status"></div>
  </div>

  <script>
    function clearSpecificUser() {
      const statusDiv = document.getElementById('status');
      const targetEmail = 'elitesquadp@protonmail.com';

      try {
        let itemsCleared = 0;

        // Clear systemUsers if it contains the target email
        const systemUsers = localStorage.getItem('systemUsers');
        if (systemUsers) {
          try {
            const users = JSON.parse(systemUsers);
            const filteredUsers = users.filter(u => u.email !== targetEmail);
            if (filteredUsers.length < users.length) {
              localStorage.setItem('systemUsers', JSON.stringify(filteredUsers));
              itemsCleared++;
              console.log('‚úÖ Removed user from systemUsers');
            }
          } catch (e) {
            console.error('Error parsing systemUsers:', e);
          }
        }

        // Clear individual user profile storage
        const userProfileKeys = Object.keys(localStorage).filter(key => key.startsWith('userProfile_'));
        for (const key of userProfileKeys) {
          try {
            const userData = JSON.parse(localStorage.getItem(key) || '{}');
            if (userData.email === targetEmail) {
              localStorage.removeItem(key);
              itemsCleared++;
              console.log('‚úÖ Removed userProfile:', key);
            }
          } catch (e) {
            console.error('Error parsing user profile:', e);
          }
        }

        // Clear current user if it matches
        const currentUser = localStorage.getItem('currentUser');
        if (currentUser) {
          try {
            const user = JSON.parse(currentUser);
            if (user.email === targetEmail) {
              localStorage.removeItem('currentUser');
              itemsCleared++;
              console.log('‚úÖ Removed currentUser');
            }
          } catch (e) {
            console.error('Error parsing currentUser:', e);
          }
        }

        // Clear user settings for the specific user
        const settingsKeys = Object.keys(localStorage).filter(key => key.startsWith('settings_'));
        for (const key of settingsKeys) {
          try {
            const settings = JSON.parse(localStorage.getItem(key) || '{}');
            if (settings.email === targetEmail || settings.user?.email === targetEmail) {
              localStorage.removeItem(key);
              itemsCleared++;
              console.log('‚úÖ Removed settings:', key);
            }
          } catch (e) {
            console.error('Error parsing settings:', e);
          }
        }

        // Show success message
        statusDiv.className = 'status success';
        statusDiv.innerHTML = `
          <strong>‚úÖ Cache cleared successfully!</strong>
          <p>Removed ${itemsCleared} cache item(s) for ${targetEmail}</p>
          <p>Reloading page in 2 seconds...</p>
        `;

        // Reload after 2 seconds
        setTimeout(() => {
          window.location.href = 'http://localhost:3000';
        }, 2000);

      } catch (error) {
        statusDiv.className = 'status error';
        statusDiv.innerHTML = `
          <strong>‚ùå Error:</strong> ${error.message}
        `;
      }
    }
  </script>
</body>
</html>
